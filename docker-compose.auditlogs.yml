version: '2.1'
services:

    #
    # auditlogs
    #
    mender-auditlogs:
        image: registry.mender.io/mendersoftware/auditlogs:staging
        extends:
            file: common.yml
            service: mender-base
        networks:
            - mender
        depends_on:
            - mender-mongo
        command: server --automigrate
        labels:
            mender.healthcheck.path: "/api/internal/v1/auditlogs/health"

    mender-api-gateway:
      volumes:
        - ./config/traefik/traefik.auditlogs.yaml:/etc/traefik/config/traefik.auditlogs.yaml:ro

    mender-device-auth:
        environment:
            DEVICEAUTH_ENABLE_AUDIT: 1

    mender-deployments:
        environment:
            DEPLOYMENTS_ENABLE_AUDIT: 1

    mender-gui:
        environment:
            HAVE_AUDITLOGS: 1

    mender-useradm:
        environment:
            USERADM_ENABLE_AUDIT: 1

    mender-workflows-worker:
        environment:
            HAVE_AUDITLOGS: 1
